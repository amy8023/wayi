webpackJsonp([55],{CYw3:function(e,t,o){var a=o("q20L");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);o("rjj0")("228c0492",a,!0)},o5eQ:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o("mvHQ"),n=o.n(a),i=o("Dd8w"),l=o.n(i),s=o("NYxO"),r=o("4cjj"),u=o("t5DY"),c=o("4/BI"),p={data:function(){return{dialogVisible_send:!1,dialogVisible_add:!1,loading:!1,tableData:[],status:"",coupon_obj:{id:"",type:"",coinId:"",amount:"",startTime:"",endTime:"",limtAmount:"",copies:"",sendWay:"",condition:[],regTime:"",monetary:[],monetaryMin:"",monetaryMax:"",userSting:"",uuid:"",num:"",remark:"",status:""},rules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:this.$t("loginForm.rules.required"),trigger:"blur"}],roles:[{type:"array",required:!0,message:"请至少选择一中角色",trigger:"change"}],code:[{required:!0,message:this.$t("loginForm.rules.required"),trigger:"blur"}],mail:[{required:!0,trigger:"blur",validator:function(e,t,o){return""==t?o(new Error("邮箱不能为空")):/^[a-zA-Z0-9_.-]+@[a-zA-Z0-9-]+(\.[a-zA-Z0-9-]+)*\.[a-zA-Z0-9]{2,6}$/.test(t)?void o():o(new Error("邮箱格式不正确"))}}]},page:{pageNO:1,pageSize:20,totalCount:""},options:[],optionsCoupon:[],optionsStatus:[]}},computed:l()({},Object(s.b)(["roles","admin","name"])),created:function(){this.init()},filters:{formatCoinType:function(e){return Object(c.a)(e)},statusFilter:function(e){return{1:"success",27:"warning"}[e]},formatStata:function(e){return{1:"矿机",27:"云算力"}[e]},formatDate:function(e){var t=new Date(e);return Object(c.b)(t,"yyyy-MM-dd hh:mm")},formatRole:function(e){return{GUESS:"算力财务",ROLE_ADMIN:"管理员",ROLE_USER:"普通用户"}[e]}},methods:{search_submit:function(e){var t=this,o={username:this.user_obj.username,phone:this.user_obj.phone,mail:this.user_obj.mail,roles:this.user_obj.roleId,status:this.user_obj.status},a={pageNum:this.page.pageNum,pageSize:this.page.pageSize,search:n()(o)};this.$refs[e].validate(function(e){e&&(t.loading=!0,getUserListByRole(a).then(function(e){t.loading=!1,e.data.type?(t.tableData=e.data.body.result,t.page.pageNum=e.data.body.pageNum,t.page.pageSize=e.data.body.pageSize,t.page.totalCount=e.data.body.totalCount):t.$message.error(e.data.body)}))})},handleAdd:function(){this.dialogVisible_add=!0,this.getCoin(),this.coupon_obj={}},addUser_submit:function(e){var t=this,o={type:this.coupon_obj.type,coinId:this.coupon_obj.coinId,amount:this.coupon_obj.amount,startTime:this.coupon_obj.startTime,endTime:this.coupon_obj.endTime,limtAmount:this.coupon_obj.limtAmount,copies:this.coupon_obj.copies};this.$refs[e].validate(function(e){e&&Object(r.b)(o).then(function(e){e.data.type?(t.$message.success("提交成功！"),t.dialogVisible_add=!1,t.init()):t.$message.error(e.data.body)})})},handleSend:function(){this.dialogVisible_send=!0,this.getStatus(),this.getCoin(),this.coupon_obj={}},send_submit:function(e){var t=this;this.coupon_obj.monetaryMin&&this.coupon_obj.monetary.push(this.coupon_obj.monetaryMin),this.coupon_obj.monetaryMax&&this.coupon_obj.monetary.push(this.coupon_obj.monetaryMax);var o={regTime:this.coupon_obj.regTime,monetary:"",userSting:this.coupon_obj.userSting},a={sendWay:this.coupon_obj.sendWay,coinId:this.coupon_obj.coinId,type:this.coupon_obj.type,uuid:this.coupon_obj.uuid,num:this.coupon_obj.num,remark:this.coupon_obj.remark,condition:n()(o)};this.$refs[e].validate(function(e){e&&Object(r.a)(a).then(function(e){e.data.type?(t.$message.success("提交成功！"),t.dialogVisible_send=!1,t.init()):(t.coupon_obj.monetary=[],t.$message.error(e.data.body))})})},init:function(){var e=this;this.loading=!0;var t={pageNO:this.page.pageNO,pageSize:this.page.pageSize,search:n()({})};Object(r.c)(t).then(function(t){e.loading=!1,t.data.type?(e.tableData=t.data.body.result,e.page.pageNO=t.data.body.pageNum,e.page.pageSize=t.data.body.pageSize,e.page.totalCount=t.data.body.totalCount):e.$message.error(t.data.body)})},handleSizeChange:function(e){this.page.pageSize=e,this.init()},handleCurrentChange:function(e){this.page.pageNO=e,this.init()},getCoin:function(){var e=this;Object(u.b)({}).then(function(t){var o=[];t.data.type?(o=t.data.body,e.options=o):e.$message.error(t.data)})},getCoupon:function(){var e=this,t={type:this.coupon_obj.type,status:this.status,coinId:this.coupon_obj.coinId};Object(r.d)(t).then(function(t){var o=[];t.data.type?(o=t.data.body,e.optionsCoupon=o):e.$message.error(t.data.body)})},getStatus:function(){var e=this;Object(u.c)({paraKey:"coupon_status"}).then(function(t){if(t.data.type){e.optionsStatus=t.data.body;for(var o=0;o<e.optionsStatus.length;o++)if(e.optionsStatus[o].paraValue="coupon_status_init"){e.status=e.optionsStatus[o].id;break}}else e.$message.error(t.data.body)})},changeBatch:function(e){for(var t=0;t<this.optionsCoupon.length;t++)if(e==this.optionsCoupon[t].uuid){this.coupon_obj.num=this.optionsCoupon[t].num;break}}}},d={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"app-container"},[o("div",[e.admin?o("el-button",{attrs:{type:"primary"},on:{click:e.handleAdd}},[e._v("生成")]):e._e(),e._v(" "),e.admin?o("el-button",{attrs:{type:"primary"},on:{click:e.handleSend}},[e._v("发放")]):e._e(),e._v(" "),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"mt_20",staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",stripe:""}},[o("el-table-column",{attrs:{prop:"uuid",label:"优惠券","min-width":"300"}}),e._v(" "),o("el-table-column",{attrs:{label:"类型",sortable:"","min-width":""},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-tag",{attrs:{size:"mini",type:e._f("statusFilter")(t.row.type)}},[e._v(e._s(e._f("formatStata")(t.row.type)))])]}}])}),e._v(" "),o("el-table-column",{attrs:{prop:"coinName",label:"币种"}}),e._v(" "),o("el-table-column",{attrs:{prop:"num",label:"数量"}}),e._v(" "),o("el-table-column",{attrs:{prop:"amount",label:"面值","min-width":"120"}}),e._v(" "),o("el-table-column",{attrs:{label:"开始时间",prop:"regDate",sortable:"","min-width":"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-tag",{attrs:{size:"mini"}},[e._v(e._s(e._f("formatDate")(t.row.startTime)))])]}}])}),e._v(" "),o("el-table-column",{attrs:{label:"结束时间",prop:"lastLoginTime",sortable:"","min-width":"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-tag",{attrs:{size:"mini"}},[e._v(e._s(e._f("formatDate")(t.row.endTime)))])]}}])}),e._v(" "),o("el-table-column",{attrs:{prop:"orderAmount",label:"使用条件","min-width":"120"}}),e._v(" "),o("el-table-column",{attrs:{label:"状态",sortable:"","min-width":"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-tag",{attrs:{size:"mini"}},[e._v(e._s(t.row.statusName))])]}}])}),e._v(" "),o("el-table-column",{attrs:{label:"生成时间",sortable:"","min-width":"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.st?o("el-tag",{attrs:{size:"mini"}},[e._v(e._s(e._f("formatDate")(t.row.st)))]):e._e()]}}])}),e._v(" "),e.admin?o("el-table-column",{attrs:{label:"管理员",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.operaterName?o("el-tag",{attrs:{size:"mini"}},[e._v(e._s(t.row.operaterName))]):e._e()]}}])}):e._e(),e._v(" "),o("el-table-column",{attrs:{prop:"orderId",label:"绑定订单","min-width":"120"}})],1),e._v(" "),e.tableData.length?o("div",{staticClass:"block"},[o("el-pagination",{attrs:{background:"","current-page":e.page.pageNum,"page-sizes":[20,100,100],"page-size":e.page.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:parseInt(e.page.totalCount)},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1):e._e(),e._v(" "),o("el-dialog",{attrs:{title:"批量生成",visible:e.dialogVisible_add},on:{"update:visible":function(t){e.dialogVisible_add=t}}},[o("el-form",{ref:"coupon_obj",attrs:{model:e.coupon_obj,rules:e.rules,"label-width":"80px"}},[o("el-form-item",{attrs:{label:"类型",prop:""}},[o("el-select",{attrs:{placeholder:""},model:{value:e.coupon_obj.type,callback:function(t){e.$set(e.coupon_obj,"type",t)},expression:"coupon_obj.type"}},[o("el-option",{attrs:{label:"算力",value:27}}),e._v(" "),o("el-option",{attrs:{label:"矿机",value:1}})],1)],1),e._v(" "),o("el-form-item",{attrs:{label:"币种",prop:""}},[o("el-select",{attrs:{placeholder:""},model:{value:e.coupon_obj.coinId,callback:function(t){e.$set(e.coupon_obj,"coinId",t)},expression:"coupon_obj.coinId"}},e._l(e.options,function(e){return o("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),o("el-form-item",{attrs:{label:"面值",prop:"amount"}},[o("el-input",{model:{value:e.coupon_obj.amount,callback:function(t){e.$set(e.coupon_obj,"amount",t)},expression:"coupon_obj.amount"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"使用条件",prop:"limtAmount"}},[o("el-input",{model:{value:e.coupon_obj.limtAmount,callback:function(t){e.$set(e.coupon_obj,"limtAmount",t)},expression:"coupon_obj.limtAmount"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"生成数量",prop:"copies"}},[o("el-input",{model:{value:e.coupon_obj.copies,callback:function(t){e.$set(e.coupon_obj,"copies",t)},expression:"coupon_obj.copies"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"开始时间"}},[o("el-date-picker",{attrs:{type:"datetime",placeholder:"收益开始时间","value-format":"yyyy-MM-dd hh:mm:ss"},model:{value:e.coupon_obj.startTime,callback:function(t){e.$set(e.coupon_obj,"startTime",t)},expression:"coupon_obj.startTime"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"结束时间"}},[o("el-date-picker",{attrs:{type:"datetime",placeholder:"收益开始时间","value-format":"yyyy-MM-dd hh:mm:ss"},model:{value:e.coupon_obj.endTime,callback:function(t){e.$set(e.coupon_obj,"endTime",t)},expression:"coupon_obj.endTime"}})],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addUser_submit("coupon_obj")}}},[e._v("保存")]),e._v(" "),o("el-button",{on:{click:function(t){e.dialogVisible_add=!1}}},[e._v("取消")])],1)],1)],1),e._v(" "),o("el-dialog",{attrs:{title:"编辑",visible:e.dialogVisible_send},on:{"update:visible":function(t){e.dialogVisible_send=t}}},[o("el-form",{ref:"coupon_obj",attrs:{model:e.coupon_obj,rules:e.rules,"label-width":"80px"}},[o("el-form-item",{attrs:{label:"发放方式",prop:""}},[o("el-select",{attrs:{placeholder:""},model:{value:e.coupon_obj.sendWay,callback:function(t){e.$set(e.coupon_obj,"sendWay",t)},expression:"coupon_obj.sendWay"}},[o("el-option",{attrs:{label:"邮箱",value:"mail"}}),e._v(" "),o("el-option",{attrs:{label:"手机",value:"phone"}})],1)],1),e._v(" "),o("el-form-item",{attrs:{label:"发放类型",prop:""}},[o("el-select",{model:{value:e.coupon_obj.type,callback:function(t){e.$set(e.coupon_obj,"type",t)},expression:"coupon_obj.type"}},[o("el-option",{attrs:{label:"算力",value:27}}),e._v(" "),o("el-option",{attrs:{label:"矿机",value:1}})],1)],1),e._v(" "),o("el-form-item",{attrs:{label:"发放币种",prop:""}},[o("el-select",{attrs:{placeholder:""},on:{change:e.getCoupon},model:{value:e.coupon_obj.coinId,callback:function(t){e.$set(e.coupon_obj,"coinId",t)},expression:"coupon_obj.coinId"}},e._l(e.options,function(e,t){return o("el-option",{key:t,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),o("el-form-item",{attrs:{label:"发放批次"}},[o("el-select",{attrs:{placeholder:""},on:{change:e.changeBatch},model:{value:e.coupon_obj.uuid,callback:function(t){e.$set(e.coupon_obj,"uuid",t)},expression:"coupon_obj.uuid"}},e._l(e.optionsCoupon,function(e,t){return o("el-option",{key:t,attrs:{label:e.uuid,value:e.uuid}})}))],1),e._v(" "),o("el-form-item",{attrs:{label:"发放数量",prop:"num"}},[o("el-input",{model:{value:e.coupon_obj.num,callback:function(t){e.$set(e.coupon_obj,"num",t)},expression:"coupon_obj.num"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"发放条件"}},[o("el-checkbox-group",{model:{value:e.coupon_obj.condition,callback:function(t){e.$set(e.coupon_obj,"condition",t)},expression:"coupon_obj.condition"}},[o("el-checkbox",{attrs:{label:"coupon_obj.regTime"}},[o("el-row",{attrs:{gutter:0}},[o("el-col",{attrs:{xs:24,sm:24,md:6,lg:6}},[e._v("\n                                注册时间\n                            ")]),e._v(" "),o("el-col",{attrs:{xs:24,sm:24,md:6,lg:18}},[o("el-date-picker",{attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd hh:mm:ss"},model:{value:e.coupon_obj.regTime,callback:function(t){e.$set(e.coupon_obj,"regTime",t)},expression:"coupon_obj.regTime"}})],1)],1)],1),e._v(" "),o("el-checkbox",{attrs:{label:"coupon_obj.monetary"}},[o("el-row",{attrs:{gutter:0}},[o("el-col",{attrs:{xs:24,sm:24,md:6,lg:6}},[e._v("\n                             消费额度\n                            ")]),e._v(" "),o("el-col",{attrs:{xs:24,sm:24,md:18,lg:8}},[o("el-input",{model:{value:e.coupon_obj.monetaryMin,callback:function(t){e.$set(e.coupon_obj,"monetaryMin",t)},expression:"coupon_obj.monetaryMin"}}),e._v("-"),o("el-input",{model:{value:e.coupon_obj.monetaryMax,callback:function(t){e.$set(e.coupon_obj,"monetaryMax",t)},expression:"coupon_obj.monetaryMax"}})],1)],1)],1),e._v(" "),o("el-checkbox",{attrs:{label:"coupon_obj.userSting"}},[o("el-row",{attrs:{gutter:0}},[o("el-col",{attrs:{xs:24,sm:24,md:6,lg:6}},[e._v("\n                               指定用户\n                            ")]),e._v(" "),o("el-col",{attrs:{xs:24,sm:24,md:6,lg:16}},[o("el-input",{attrs:{type:"textarea",rows:4,placeholder:"请输入用户,逗号分隔"},model:{value:e.coupon_obj.userSting,callback:function(t){e.$set(e.coupon_obj,"userSting",t)},expression:"coupon_obj.userSting"}})],1)],1)],1)],1)],1),e._v(" "),o("el-form-item",{attrs:{label:"备注",prop:"remark"}},[o("el-input",{attrs:{type:"textarea"},model:{value:e.coupon_obj.remark,callback:function(t){e.$set(e.coupon_obj,"remark",t)},expression:"coupon_obj.remark"}})],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.send_submit("coupon_obj")}}},[e._v("发放")]),e._v(" "),o("el-button",{on:{click:function(t){e.dialogVisible_send=!1}}},[e._v("取消")])],1)],1)],1)],1)])},staticRenderFns:[]};var b=o("VU/8")(p,d,!1,function(e){o("CYw3")},"data-v-65f1bea7",null);t.default=b.exports},q20L:function(e,t,o){(e.exports=o("FZ+f")(!1)).push([e.i,"\n.block[data-v-65f1bea7] {\n        text-align: center;\n        margin-top: 20px\n}\n.content[data-v-65f1bea7]{background: #fff\n}\n.mt_20[data-v-65f1bea7]{margin-top: 20px\n}\n.el-checkbox[data-v-65f1bea7]:first-child{margin-left: 30px\n}\n.pull-right[data-v-65f1bea7]{float: right\n}\n.auth_input[data-v-65f1bea7]{width: 100px;\n}\n.auth_text[data-v-65f1bea7]{font-size: 12px;\n}\n.auth_select[data-v-65f1bea7]{width: 100px\n}\n.mr_10[data-v-65f1bea7]{margin-right: 10px\n}\n.el-date-editor.el-input[data-v-65f1bea7], .el-date-editor.el-input__inner[data-v-65f1bea7]{width:100%\n}\n",""])}});
